#!/usr/bin/bash

# Uninstall incompatible Fabric and related packages from global environment
#pip3 uninstall -y Fabric3 fabric cryptography bcrypt PyNaCl pyparsing appdirs setuptools paramiko

# Remove previous system-wide installed packages
#sudo apt-get remove --purge -y libffi-dev libssl-dev build-essential
#sudo apt-get autoremove -y
#sudo apt-get clean

# Install system-wide dependencies
#sudo apt-get update
sudo apt-get install -y build-essential libssl-dev libffi-dev libbz2-dev libreadline-dev libsqlite3-dev wget

# Download and build Python 3.4 from source
wget https://www.python.org/ftp/python/3.4.10/Python-3.4.10.tgz
tar xzf Python-3.4.10.tgz
cd Python-3.4.10
./configure --enable-optimizations
make -j$(nproc)
sudo make altinstall
cd ..

# Install virtualenv
#sudo apt-get install -y python3-pip
#pip3 install virtualenv

# Create a virtual environment with Python 3.4
virtualenv -p /usr/local/bin/python3.4 myenv

# Activate the virtual environment
source myenv/bin/activate

# Install Fabric and its dependencies in the virtual environment
#pip install fabric3 cryptography==2.8 bcrypt==3.1.7 PyNaCl==1.3.0

echo "Setup complete. To activate the virtual environment, run 'source myenv/bin/activate'."

